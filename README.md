# fp-cnn
End-to-end frame work to map a CNN onto FPGA.

## How to generate the accelerator
- Specify the network configuration

   The network configuration file is `model/<your_model_name>/nn_configs.txt` where `<your_model_name>` is the 
   name of the model. We have provided a reference network configuration for MNIST under `model/MNIST`.
   
   `nn_configs.txt` should be generated by our Tensorflow API wrapper. During our project, we use the nn-quant
   library from Ritchie to specify the model and dump weights. We will provide the wrapper after nn-quant, which
   is currently private, becomes public. 
   
- Provide the weight file
   
   The network configuration file is `model/<your_model_name>/_dump.npy` where `<your_model_name>` is the 
   name of the model. We have provided a reference binary weight file for MNIST under `model/MNIST`.
   
   `_dump.npy` should be generated by `--save-activations` option of the nn-quant library. 
   During our project, we got the permission from Ritchie to use this library but it is private. You can access
   this library after it becomes public.
   
- Run the generation framework
 
    `source utils/gen.sh`
    
    The above command will generate a new SDAccel project under `src/<you_model_name>/`. All files should be ready
    and you can run software/hardware emulation there.
    
## How to use the makefile inside the SDAccel project directory
- Software emulation   
~~~
make -f sdaccel.mk run_cpu_em
~~~

- Hardware emulation   
~~~
make -f sdaccel.mk run_hw_emu
~~~

- Run on board   
~~~
make -f sdaccel.mk run_hw
~~~

- Clean   
~~~
make -f sdaccel.mk cleanall
~~~
